import{j as e,b5 as f,bh as S,aA as T,by as K,bD as u,r as j,bA as R,bB as B,bC as y}from"./index-i_H5Jyig.js";import{u as L}from"./useExportCsv-BdOkdDsf.js";const z=({data:o})=>{const i=()=>e.jsx("div",{children:e.jsx(T,{fullWidth:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{height:28,fontSize:"0.75rem"},"& .MuiOutlinedInput-input":{padding:"4px 6px"}}})}),n=(t,a,c)=>{const s=t[a];return e.jsxs(f.Fragment,{children:[e.jsx("tr",{children:e.jsxs("td",{colSpan:"9",className:"section-header",children:[t.year," - ",c]})}),s.length>0?s.map((r,x)=>e.jsxs("tr",{className:"editable_content",children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:i()}),e.jsx("td",{children:e.jsx(S,{})}),e.jsx("td",{children:i()}),e.jsx("td",{children:i()}),e.jsx("td",{children:i()}),e.jsx("td",{children:i()}),e.jsx("td",{children:i()}),e.jsx("td",{children:e.jsx("div",{children:e.jsx("button",{className:"main_btn_style",children:"save"})})})]},x)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"9",children:["No records for ",c]})})]},a)};return e.jsx("div",{className:"table",children:e.jsxs("table",{children:[e.jsx("thead",{className:"shadow fixed-header",children:e.jsxs("tr",{children:[e.jsx("th",{children:"School Name"}),e.jsx("th",{children:"Enrolled"}),e.jsx("th",{children:"Distr."}),e.jsx("th",{children:"Number of Classrooms"}),e.jsx("th",{children:"Number of Consent Packer"}),e.jsx("th",{children:"Total Number of Forms Distr."}),e.jsx("th",{children:"Consents"}),e.jsx("th",{children:"Nurse / Contact Person"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:o.map((t,a)=>e.jsxs(f.Fragment,{children:[n(t,"preK","Pre K"),n(t,"k5","K-5"),n(t,"m6_8","Middle 6-8"),n(t,"high9_12","High 9-12")]},a))})]})})},A=(o,i)=>{const n=s=>s?s.toString().toLowerCase():"",t=n(i.search||""),a=i.year;return o.filter(s=>!a||s.year===a).map(s=>({...s,preK:s.preK.filter(r=>n(r.name).includes(t)),k5:s.k5.filter(r=>n(r.name).includes(t)),m6_8:s.m6_8.filter(r=>n(r.name).includes(t)),high9_12:s.high9_12.filter(r=>n(r.name).includes(t))})).filter(s=>s.preK.length||s.k5.length||s.m6_8.length||s.high9_12.length)},O=()=>{const{filters:o,rowsPerPage:i,currentPage:n,currentPageData:t,totalPages:a,handleFilterChange:c,handleRowsPerPageChange:s,handlePageChange:r,loading:x}=K(u,{search:"",year:"Csdp Program Sy 2020 - 2021"},A),g=L(),m=j.useRef(null);j.useRef(!1);const p=()=>{const h=(N=>{const b=[];return N.forEach(_=>{const{year:C,preK:P,k5:k,m6_8:v,high9_12:E}=_;[P,k,v,E].forEach((F,w)=>{const D=["preK","k5","m6_8","high9_12"][w];F.forEach(l=>{b.push({year:C,group:D,name:l.name,enrolled:l.enrolled,distribution:l.distribution,classroomNum:l.classroomNum,consentPackerNum:l.consentPackerNum,totalFormsDisNum:l.totalFormsDisNum,consents:l.consents,nurse_contact_person:l.nurse_contact_person})})})}),b})(u);g(h,"Distribution.csv")};return j.useEffect(()=>{const d=m.current,h=()=>{};return d&&d.addEventListener("scroll",h),()=>{d&&d.removeEventListener("scroll",h)}},[]),e.jsxs("div",{className:"distribution auto-sizing",children:[e.jsx(R,{filters:o,onFilterChange:c,data:u,hasYearFilter:!0}),e.jsxs("div",{className:"table_controls",children:[e.jsx("button",{className:"Export_BTN shadow",onClick:p,children:"Export"}),e.jsx(B,{rowsPerPage:i,handleRowsPerPageChange:s})]}),e.jsx("div",{className:"table_area",ref:m,children:x?e.jsx(y,{}):e.jsx("div",{className:"container",children:e.jsx(z,{data:t})})}),a>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"shadow",onClick:()=>r(n-1),disabled:n===1,children:"Back"}),e.jsxs("span",{children:["Page ",n," of ",a]}),e.jsx("button",{className:"shadow",onClick:()=>r(n+1),disabled:n===a,children:"Next"})]})]})};export{O as default};
